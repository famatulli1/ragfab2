# ============================================
# Thumbs Down Worker Configuration
# ============================================

# -------------------------------------------
# Database Configuration
# -------------------------------------------
DATABASE_URL=postgresql://raguser:ragpass@ragfab-postgres.internal:5432/ragdb

# -------------------------------------------
# Generic LLM Configuration
# -------------------------------------------
# URL de l'API LLM (Mistral, Chocolatine, ou autre OpenAI-compatible)
LLM_API_URL=https://api.mistral.ai

# Clé API LLM
LLM_API_KEY=your-mistral-api-key-here

# Modèle à utiliser pour analyse
LLM_MODEL_NAME=mistral-small-latest

# Utiliser function calling (false pour thumbs down worker)
LLM_USE_TOOLS=false

# Timeout requêtes LLM (secondes)
LLM_TIMEOUT=120.0

# -------------------------------------------
# Legacy LLM Configuration (rétrocompatibilité)
# -------------------------------------------
# Mistral API (ancien format)
MISTRAL_API_KEY=your-mistral-api-key-here
MISTRAL_MODEL_NAME=mistral-small-latest

# Chocolatine API (provider alternatif)
CHOCOLATINE_API_URL=https://apigpt.mynumih.fr
CHOCOLATINE_API_KEY=
CHOCOLATINE_MODEL_NAME=jpacifico/Chocolatine-2-14B-Instruct-v2.0.3

# -------------------------------------------
# Thumbs Down Worker Configuration
# -------------------------------------------
# Activer l'analyse IA automatique des thumbs down (true/false)
# true = Worker écoute les notifications PostgreSQL et déclenche analyses automatiquement
# false = Analyses manuelles uniquement via API
# RECOMMANDÉ: true (permet détection immédiate des problèmes)
THUMBS_DOWN_AUTO_ANALYSIS=true

# Seuil de confidence pour déclencher révision admin (0.0-1.0)
# Si confidence IA < seuil → needs_admin_review = true
# 0.7 = Équilibre (12-15% des cas nécessitent révision)
# 0.6 = Plus permissif (20-25% des cas)
# 0.8 = Plus strict (5-10% des cas)
# RECOMMANDÉ: 0.7 (détecte les cas ambigus sans surcharger admin)
THUMBS_DOWN_CONFIDENCE_THRESHOLD=0.7

# Provider LLM pour analyse des thumbs down (mistral ou chocolatine)
# Utilisera les mêmes credentials que LLM_API_URL/LLM_API_KEY
# RECOMMANDÉ: mistral (meilleure classification en JSON)
THUMBS_DOWN_LLM_PROVIDER=mistral

# Activer les notifications utilisateurs automatiques (true/false)
# true = Crée notifications pédagogiques pour utilisateurs avec bad_question
# false = Notifications manuelles uniquement via admin
# RECOMMANDÉ: true (améliore formulation questions des utilisateurs)
THUMBS_DOWN_AUTO_NOTIFICATIONS=true

# -------------------------------------------
# Logs
# -------------------------------------------
LOG_LEVEL=INFO
